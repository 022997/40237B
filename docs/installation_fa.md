# مراحل نصب


## نصب به صورت Cloudflare Pages
### مقدمه

احتمالاً آگاهید که ما دو روش برای ساخت پروکسی روی کلادفلر داریم، Worker و Pages. حالا نکته اینجاست که روش Worker که مرسوم‌تره یه محدودیت داره یعنی روزانه صدهزار Request بیشتر به شما نمیده که برای مصرف ۲-۳ نفر کافیه البته. برای دور زدن این محدودیت ما یه دامنه به ورکر وصل میکردیم (که ظاهرا باگ کلادفلر هست) و اینجوری نامحدود میشد. اما Pages این محدودیت رو نداره. البته چون ما از امکان Pages functions استفاده میکنیم  مثل ورکر محدودیت داره و ممکنه ایمیل بگیرید که ظرفیتش پر شده، ولی طبق تجربه قطع نمیشه. در این روش حتی اگر از دامنه شخصی هم استفاده کنید باز این ایمیل رو دریافت می کنید. ولی در نهایت تجربه نشون داده که سرویس شما قطع نخواهد شد.

مزیت  مهم دیگه‌ش نحوه یروزرسانی هست وقتی آپدیتی برای پروژه میاد، که در ادامه آموزش میدم.
#### قدم اول - Github:
شما میرید به آدرس github.com و یه اکانت میسازید مثل هر سایت دیگه. و بعدش لاگین میکنید.

میرید به آدرس گیتهاب BPB:

[BPB-Worker-Panel](https://github.com/bia-pain-bache/BPB-Worker-Panel)

و از اون بالا دکمه Fork رو میزنید.

![Alt Text](docs\assets\Frok.png)

تو صفحه‌ی بعدی به هیچی دست نزنید و Create Fork رو بزنید.



خب کار ما با گیتهاب تموم شد.

#### قدم دوم - ساخت Cloudflare KV:
فکر کنم همه اینو بلدید، میریم داخل اکانت کلادفلر از منوی سمت چپ میریم به قسمت KV:

میزنیم Create a namespace و یه اسم دلخواه بهش میدیم و Add میکنیم.

#### قدم سوم - Cloudflare Pages:
حالا وارد قسمت Workers and Pages بشید همونجا که ورکر میساختیم و Create Application رو بزنید. با این تفاوت این دفعه Pages رو انتخاب میکنیم:

اینجا Connect to Git رو میزنید و میرید مرحله بعد:

اینجا روی BPB-Worker-Panel کلیک کنید تا فعال بشه و Begin Setup رو بزنید. مرحله‌ی بعد یه Project Name داره که میشه دامین پنل شما، اونو حتما عوض کنید یه اسم دلخواه بذارید.

حالا اینجا یه فرقی با ورکر داره، یعنی اگر بخواید UUID یا Proxy IP رو عوض کنید دیکه نمیتونید برید توی کد تغییر بدید، تو همین صفحه میاید پایین و قسمت Environment variables (advanced) رو باز میکنید:

اینجا باید مقادیر رو مشخص کنید. یه بار Add variable بزنید و خونه اول رو بنویسید UUID با حروف بزرگ، بعد از این لینک یه UUID بگیرید و بذارید خونه دوم:

[UUID Generator](https://www.uuidgenerator.net/)

حالا یه بار دیگه Add variable بزنید خونه اول PROXYIP با حروف بزرگ، IP رو هم میتونید از لینکای زیر بگیرید:

[Proxy IP](https://www.nslookup.io/domains/cdn.xn--b6gac.eu.org/dns-records/)

[Proxy IP](https://www.nslookup.io/domains/cdn-all.xn--b6gac.eu.org/dns-records/)

دیگه الان میتونید Save and Deploy رو بزنید.

یه چند ثانیه زمان میخواد تا پروژه نصب بشه، صبر کنید تا دکمه‌ی Continue to Project ظاهر بشه و بزنید و برید تو صفحه‌ی پروژه. حالا با توجه به عکس زیر برید قسمت Settings و بعد Functions:

اینجا مثل ورکر تو صفحه قسمت KV namespace bindings رو پیدا کنید، Add binding بزنید و Variable name باید حتما bpb باشه (همینجوری که نوشتم) و KV namespace اون KV رو انتخاب میکنید که مرحله دو ساختید و save میکنید.

خب کارمون با KV تموم شد، حالا فقط باید دوباره Deploy کنیم که تغییرات KV اعمال بشه.

از نوار بالا به قسمت Deployment برگردید و از بخش Production برید به view details:

حالا تو قسمت Deployment detail دکمه‌ی Manage Deployment رو بزنید و Retry deployment:

چند ثانیه صبر میکنید تا مراحلش تموم شه و کار ما تموم شد!

یه Back بزنید و از قسمت Production روی visit site بزنید، بعد یه panel/ تهش اضافه کنید و وارد پنل بشید.

آموزشها و نکات هم که تو آموزش اصلی هست:

[Tutorial Link](https://tinyurl.com/22z4ekr6)

#### قدم چهارم - آپدیت کردن:
یکی از مزیت‌های Pages نسبت به Worker اینه که وقتی آپدیتی برای کد منتشر میشه دیگه نیازی نیست برید ورژن جدید worker.js رو دانلود کنید و روز از نو روزی از نو! اصلا برای آپدیت دیگه کاری به کلادفلر ندارید. کافیه به گیتهاب خودتون برید وارد ریپازیتوری BPB-Worker-Panel بشید و از اینجا Sync fork رو بزنید:

بعد یه سری تغییرات ورژن جدید رو نشون میده و Update branch رو میزنید. خوبیش اینه که با این کار Cloudflare Pages خودش متوجه میشه و در حدود ۱ دقیقه بعد خودبخود آپدیت میکنه براتون.


## نصب به صورت Cloudflare Worker
